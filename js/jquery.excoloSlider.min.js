/*!
 * Excolo Slider - A simple jquery slider
 *
 * Examples and documentation at:
 * http://excolo.github.io/Excolo-Slider/
 *
 * Author: Nikolaj Dam Larsen
 * Version: 0.1.4 (19-MAY-2013)
 *
 * Released under the MIT license
 * https://github.com/Excolo/ExcoloSlider/blob/master/MIT-License.txt
 */
;(function(f,d,a,g){var b="0.1.4";var e="excoloSlider";var c=(function(){function h(j,i){this.elem=j;this.$elem=f(j);this.options=i;this.metadata=this.$elem.data("plugin-options")}return h})();c.prototype={defaults:{width:800,height:530,autoSize:true,keyboardNav:true,touchNav:true,startSlide:1,autoPlay:true,delay:0,interval:3000,repeat:true,playReverse:false,hoverPause:true,animationCssTransitions:true,animationDuration:500,animationTimingFunction:"linear",activeSlideClass:"es-active"},init:function(){var i=this;i.config=f.extend({},i.defaults,i.options,i.metadata);i.data=f.data(i);f.data(i,"currentSlide",i.config.playReverse&&i.config.startSlide==1?i.$elem.children().length-1:i.config.startSlide-1);f.data(i,"nextSlide",i.data.currentSlide);f.data(i,"totalslides",i.$elem.children().length);f.data(i,"browserEnginePrefix",i._getBrowserEnginePrefix());f.data(i,"isPlaying",false);f.data(i,"isAnimating",false);f.data(i,"playPaused",false);f.data(i,"justTouched",false);f.data(i,"width",i.config.width);if(typeof TouchEvent!=="undefined"){f.data(this,"touchEnabled",true)}i.$elem.css({position:"relative"});i.$elem.wrapInner("<div class='slide-wrapper'>",i.$elem).children();i.$elem.wrapInner("<div class='slide-container'>",f(".slide-wrapper",i.$elem)).children();f(".slide-wrapper",i.$elem).children().addClass("slide").css({position:"absolute",top:0,left:0,width:i.data.width,height:i.config.height,zIndex:0,display:"none",webkitBackfaceVisibility:"hidden"});var h=f(".slide-wrapper",i.$elem).children().height();f(".slide-wrapper",i.$elem).css({position:"relative",left:0,height:h});f(".slide-container",i.$elem).css({width:i.data.width,overflow:"hidden",height:h});if(i.config.touchNav&&i.data.touchEnabled){f(".slide-wrapper",i.$elem).on("touchstart",function(j){return i._onTouchStart(j)});f(".slide-wrapper",i.$elem).on("touchmove",function(j){return i._onTouchMove(j)});f(".slide-wrapper",i.$elem).on("touchend",function(j){return i._onTouchEnd(j)})}if(i.config.keyboardNav){f(d).keydown(function(j){return i._onKeyboardNav(j)})}if(i.config.autoSize){setTimeout(function(){i._resize()},50);f(d).resize(function(){return setTimeout(function(){i._resize()},50)})}i._prepareslides();i.gotoSlide(i.data.currentSlide);if(i.config.autoPlay){setTimeout(function(){i.start()},i.config.delay)}return this},previous:function(){var h=this;f.data(h,"slideDirection","previous");var i=(h.data.nextSlide-1)%h.data.totalslides;if(!h.config.repeat&&(h.data.nextSlide-1)<0){if(h.config.playReverse){f.data(h,"playPaused",true);h.stop()}return}else{if(h.data.playPaused&&(h.data.nextSlide-1)>0){f.data(h,"playPaused",false);h.start()}}f.data(h,"nextSlide",i);return this._slide()},next:function(){var h=this;f.data(h,"slideDirection","next");var i=(h.data.nextSlide+1)%h.data.totalslides;if(!h.config.repeat&&(h.data.nextSlide+1)>(h.data.totalslides-1)){if(!h.config.playReverse){f.data(h,"playPaused",true);h.stop()}return}else{if(h.data.playPaused&&(h.data.nextSlide+1)<(h.data.totalslides-1)){f.data(h,"playPaused",false);h.start()}}f.data(h,"nextSlide",i);return this._slide()},start:function(){var i=this;var h=f(".slide-container",i.$elem);if(i.data.isPlaying&&i.data.playTimer){clearInterval(i.data.playTimer)}var j=setInterval((function(){if(i.config.playReverse){i.previous()}else{i.next()}}),i.config.interval);f.data(i,"playTimer",j);if(i.config.hoverPause){h.unbind();h.bind("mouseenter",function(){f.data(i,"playPaused",true);return i.stop()});h.bind("mouseleave",function(){f.data(i,"playPaused",false);return i.start()})}f.data(i,"isPlaying",true)},stop:function(){var i=this;var h=f(".slide-container",i.$elem);clearInterval(i.data.playTimer);f.data(i,"playTimer",null);if(i.config.hoverPause&&!i.data.playPaused){h.unbind()}f.data(i,"isPlaying",false)},gotoSlide:function(m){var j=this;f.data(j,"nextSlide",(m)%j.data.totalslides);var i=(m)%j.data.totalslides;f.data(j,"currentSlide",i);var n=f(".slide-wrapper",j.$elem);var l=n.children();var k=n.children(":eq("+i+")");var h=k.position().left;l.removeClass(j.config.activeSlideClass);k.addClass(j.config.activeSlideClass);if(j.config.animationCssTransitions&&j.data.browserEnginePrefix){j._transition((-h),0)}else{n.position().left=-h}j._alignSlides(h)},_manualInterference:function(){var h=this;if(h.data.isPlaying){h.stop();h.start()}},_prepareslides:function(){var l=this;var n=f(".slide-wrapper",l.$elem);var m=n.children();var j=l.data.width;var k=Math.floor(l.data.totalslides/2);var h=0;m.each(function(){f(this).css({display:"block",left:j*h,zIndex:10});h++;if(l.config.repeat&&h>k){h=l.data.totalslides%2?-k:-(k-1)}})},_onKeyboardNav:function(j){var i=this;var h=j.which;switch(h){case 37:i.previous();i._manualInterference();break;case 39:i.next();i._manualInterference();break}j.preventDefault()},_onTouchStart:function(k){var j=this;var h=k.originalEvent.touches[0];var i=j.data.browserEnginePrefix.css;f.data(j,"touchTime",Number(new Date()));f.data(j,"touchedX",h.pageX);f.data(j,"touchedY",h.pageY);if(j.data.isPlaying){f.data(j,"playPaused",true);j.stop()}return k.stopPropagation()},_onTouchMove:function(n){var h=this;var o=n.originalEvent.touches[0];var p=f(".slide-wrapper",h.$elem);f.data(h,"scrolling",Math.abs(o.pageX-h.data.touchedX)<Math.abs(o.pageY-h.data.touchedY));if(!h.data.scrolling&&!h.data.isAnimating){n.preventDefault();var l=p.children(":eq("+h.data.nextSlide+")");var k=l.position().left;var m=h.data.browserEnginePrefix.css;var i=o.pageX-h.data.touchedX;var j=h.data.width*0.1;if(!h.config.repeat){if(h.data.currentSlide<=0&&-i<-j){i=j}else{if(h.data.currentSlide>=(h.data.totalslides-1)&&-i>j){i=-j}}}h._transition(-k+i,0)}return n.stopPropagation()},_onTouchEnd:function(k){var h=this;var n=k.originalEvent.touches[0];var o=f(".slide-wrapper",h.$elem);f.data(h,"justTouched",true);var j=o.children(":eq("+h.data.nextSlide+")");var i=j.position().left;var p=h.data.width*0.5;var l=h.data.width*0.1;var m=(Number(new Date())-h.data.touchTime<250);if(!h.config.repeat&&(o.position().left<-(i)&&h.data.currentSlide>=(h.data.totalslides-1)||o.position().left>(-i)&&h.data.currentSlide<=0)){h._transition((-i),0.15)}else{if(o.position().left>(-i+p)||(o.position().left>(-i+l)&&m)){this.previous()}else{if(o.position().left<-(i+p)||(o.position().left<-(i+l)&&m)){this.next()}else{h._transition((-i),0.15)}}}h._alignSlides(i);if(h.data.playPaused){h.start()}return k.stopPropagation()},_alignSlides:function(r){var j=this;if(!j.config.repeat){return}var s=f(".slide-wrapper",j.$elem);var q=s.children();if(r===g){var o=s.children(":eq("+j.data.nextSlide+")");r=o.position().left}r=Math.round(r,0);var t=Math.ceil(j.data.totalslides/2);var k=j.data.width;var h=0;q.each(function(){var i=f(this).position().left;if(i>r-k){h++}});var l=t-h;if(l<0){l=j.data.totalslides%2==0?l+1:l}for(var n=0;n<Math.abs(l);n++){var m=[].reduce.call(q,function(i,u){return f(i).offset().left<f(u).offset().left?i:u});var p=[].reduce.call(q,function(i,u){return f(i).offset().left>f(u).offset().left?i:u});if(l>0){f(m).css("left",Math.round(f(p).position().left+k))}else{f(p).css("left",Math.round(f(m).position().left-k))}}},_slide:function(){var j=this;var l=j.data.nextSlide;var h=j.data.currentSlide;var r=f(".slide-wrapper",j.$elem);var q=r.children();var o=r.children(":eq("+l+")");var n=r.children(":eq("+h+")");var m=j.config.activeSlideClass;var i=j.data.width;var p=Math.round(n.position().left);var k=Math.round(o.position().left);q.removeClass(m);o.addClass(m);j._alignSlides(k);f.data(j,"isAnimating",true);if(j.config.animationCssTransitions&&j.data.browserEnginePrefix){j._transition((-k),(j.data.justTouched?0.5:1));r.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){f.data(j,"currentSlide",l);f.data(j,"isAnimating",false);f.data(j,"justTouched",false);r.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd")})}else{r.stop().animate({left:-k},j.config.animationDuration,function(){f.data(j,"currentSlide",l);f.data(j,"isAnimating",false);f.data(j,"justTouched",false)})}},_transition:function(i,k){var m=this;var o=f(".slide-wrapper",m.$elem);if(k===g||k<0){k=1}var l=m.data.browserEnginePrefix.css;var h=l+"Transform";var n=l+"TransitionDuration";var j=l+"TransitionTimingFunction";o[0].style[h]="translateX("+i+"px)";o[0].style[n]=(m.config.animationDuration*k)+"ms";o[0].style[j]=m.config.animationTimingFunction},_resize:function(){var l=this;if(l.data.isPlaying){f.data(l,"playPaused",true);l.stop()}var h=l.$elem.width();var j=l.config.height/l.config.width;var i=h*j;f.data(l,"width",h);f(".slide",l.$elem).css({width:h,height:i});var k=f(".slide-wrapper",l.$elem).children().height();f(".slide-wrapper",l.$elem).css({height:k});f(".slide-container",l.$elem).css({width:h,height:k});if(l.data.playPaused){f.data(l,"playPaused",false);l.start()}l._prepareslides();l.gotoSlide(l.data.currentSlide)},_getBrowserEnginePrefix:function(){var j="Transition";var k=["Moz","Webkit","Khtml","O","ms"];var h=0;while(h<k.length){if(typeof a.body.style[k[h]+j]==="string"){return{css:k[h]}}h++}return false}};c.defaults=c.prototype.defaults;f.fn.excoloSlider=function(h){return this.each(function(){new c(this,h).init()})}})(jQuery,window,document);